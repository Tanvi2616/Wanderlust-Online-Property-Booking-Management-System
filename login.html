<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Login - Wanderlust</title>
<link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.2/dist/css/bootstrap.min.css" rel="stylesheet">
<link rel="stylesheet" href="css/style.css">
</head>
<body class="bg-light">

<div id="navbar"></div>

<div class="container mt-5">
  <h2 class="text-center mb-4">Login to Wanderlust</h2>

  <form id="loginForm" class="card p-4 shadow-sm">
    <div class="mb-3">
      <label class="form-label">Email</label>
      <input type="email" class="form-control" name="email" required>
    </div>
    <div class="mb-3">
      <label class="form-label">Password</label>
      <input type="password" class="form-control" name="password" required>
    </div>
    <button type="submit" class="btn btn-primary w-100">Login</button>

    <p class="text-center mt-3">
      Don't have an account? <a href="register.html" style="color:#FF5A5F; font-weight:bold;">Sign Up</a>
    </p>
  </form>

  <div id="message" class="text-center mt-3"></div>
</div>

<script>
document.getElementById("loginForm").addEventListener("submit", async function(e){
  e.preventDefault();
  const formData = new FormData(this);

  try {
    const res = await fetch("login.php", { method: "POST", body: formData });
    const data = await res.json();
    console.log('login response:', data);

    if (data.success) {
      // store role & name in sessionStorage (used by navbar)
      sessionStorage.setItem('user_role', data.role);
      sessionStorage.setItem('user_name', data.name);

      window.location.href = "index.html";
    } else {
      document.getElementById("message").innerHTML = `<div class="alert alert-danger">${data.message}</div>`;
    }
  } catch (err) {
    console.error("Error during login:", err);
    document.getElementById("message").innerHTML = `<div class="alert alert-danger">Login failed. Check console.</div>`;
  }
});
</script>

<script src="js/loadComponents.js"></script>
</body>
</html>
